<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>My Account</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-lrPQu9uOd9PTk7m6XOmtjInd7XPZQX6KVo+lgCoXAzFAIQysjTkyXU64BjBTIyDkZN6mHC7l2hXnR2kwld2n6g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<style>
  body {
    font-family: 'Nunito Sans', sans-serif;
    background-color: #f2f2f2;
    color: #333;
  }

  .account-sides-wrap {
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    overflow: hidden;
  }

  .account-sides-info {
    padding: 1.5rem;
  }

  .account-sides-info .head {
    text-align: center;
    margin-bottom: 1.5rem;
  }

  .portrait {
    width: 100px;
    height: 100px;
    margin: 0 auto 0.75rem;
    border-radius: 50%;
    overflow: hidden;
    border: 2px solid #eee;
  }

  .portrait img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .account-name {
    font-size: 1.1rem;
    font-weight: 700;
  }

  .account-email {
    font-size: 0.9rem;
    color: #777;
  }

  .account-links {
    border: none;
    padding: 0;
    margin: 0;
  }

  .account-links a {
    font-weight: 500;
    color: #555;
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #eee;
    text-decoration: none;
    transition: background 0.3s, color 0.3s;
  }

  .account-links a:last-child {
    border-bottom: none;
  }

  .account-links a.active,
  .account-links a:hover {
    background: #fef9f6;
    color: #fd6727;
  }

  .account-card {
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    border: none;
    background: #fff;
  }

  .card-header {
    background: #fff;
    border-bottom: 1px solid #eee;
    padding: 1rem 1.5rem;
  }

  .card-title {
    margin: 0;
    font-weight: 700;
  }

  .card-header a {
    font-size: 0.9rem;
    text-decoration: none;
    color: #999;
    transition: color 0.3s;
  }

  .card-header a:hover {
    color: #333;
  }

  .card-body {
    padding: 1.5rem;
  }

  .card-items {
    display: flex;
    gap: 2rem;
    justify-content: center;
  }

  .card-items a {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: #666;
    text-decoration: none;
    transition: color 0.3s;
  }

  .card-items a:hover {
    color: #fd6727;
  }

  .card-items a i {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
  }

  .table {
    vertical-align: middle;
  }

  .table td {
    vertical-align: middle;
  }

  .table .img {
    border-radius: 8px;
    background: #fff;
    overflow: hidden;
  }

  .wh-60 {
    width: 60px;
    height: 60px;
  }

  .vr {
    width: 1px;
    background-color: #ccc;
    display: inline-block;
    height: 16px;
    vertical-align: middle;
    margin: 0 8px;
  }

  .btn-outline-secondary {
    border-radius: 20px;
    font-weight: 600;
    transition: background 0.3s, color 0.3s;
  }

  .btn-outline-secondary:hover {
    background-color: #fd6727;
    border-color: #fd6727;
    color: #fff;
  }

  @media (max-width: 767px) {
    .card-items {
      flex-wrap: wrap;
      gap: 1rem;
    }
    .account-sides-wrap {
      margin-bottom: 1rem;
    }
    .portrait {
      width: 80px;
      height: 80px;
    }
    .account-name {
      font-size: 1rem;
    }
  }

</style>
</head>
<body>

<div class="container py-4">
  <div class="row g-4">
    <div class="col-12 col-md-3">
      <div class="account-sides-wrap">
        <div class="account-sides-info">
          <div class="head">
            <div class="portrait">
              <img src="http://beikeshop.local/cache/catalog/placeholder-200x200.png" class="img-fluid">
            </div>
            <div class="account-name">593098055</div>
            <div class="account-email">593098055@qq.com</div>
          </div>

          <nav class="list-group account-links">
            <a class="list-group-item active" href="http://beikeshop.local/account">Account</a>
            <a class="list-group-item" href="http://beikeshop.local/account/edit">Edit</a>
            <a class="list-group-item" href="http://beikeshop.local/account/password">Change password</a>
            <a class="list-group-item" href="http://beikeshop.local/account/orders">Order</a>
            <a class="list-group-item" href="http://beikeshop.local/account/addresses">Addresses</a>
            <a class="list-group-item" href="http://beikeshop.local/account/wishlist">Wishlist</a>
            <a class="list-group-item" href="http://beikeshop.local/account/rmas">RMA</a>
            <a class="list-group-item" href="http://beikeshop.local/logout">Sign Out</a>
          </nav>
        </div>
      </div>
    </div>

    <div class="col-12 col-md-9">
      <div class="card account-card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h5 class="card-title mb-0">My Order</h5>
          <a href="http://beikeshop.local/account/orders" class="text-muted">All Orders &rarr;</a>
        </div>
        <div class="card-body">
          <div class="d-flex flex-nowrap card-items mb-4 py-3">
            <a href="http://beikeshop.local/account/orders?status=unpaid" class="text-center"><i class="fas fa-wallet"></i><span class="text-muted">Unpaid</span></a>
            <a href="http://beikeshop.local/account/orders?status=paid" class="text-center"><i class="fas fa-box-open"></i><span class="text-muted">Unshipped</span></a>
            <a href="http://beikeshop.local/account/orders?status=shipped" class="text-center"><i class="fas fa-shipping-fast"></i><span class="text-muted">Shipped</span></a>
            <a href="http://beikeshop.local/account/rmas" class="text-center"><i class="fas fa-undo-alt"></i><span class="text-muted">RMA</span></a>
          </div>

          <div class="order-wrap">
            <div class="table-responsive">
              <table class="table align-middle">
                <tbody>
                  <% if @customer_user.orders.present? %>
                     <% @customer_user.orders.each do |order| %>
                      <tr>
                        <td style="width: 62px">
                          <div class="img border wh-60 d-flex justify-content-center align-items-center">
                            <% first_item = order.order_items.first %>
                            <% if first_item && first_item.product && first_item.product.images.attached? %>
                              <%= image_tag first_item.product.images.first, class: "img-fluid", style: "object-fit: cover; width:60px; height:60px;" %>
                            <% else %>
                              <img src="/placeholder-product.png" class="img-fluid">
                            <% end %>
                          </div>
                        </td>
                        <td>
                          <div class="mb-2 text-nowrap">
                            Order Number：<span style="width: 110px;display: inline-block;"><%= order.id %></span><span class="vr"></span>
                            All <%= order.order_items.count %> Items
                          </div>
                          <div class="text-muted">
                            Order Time：<%= order.created_at.strftime("%Y-%m-%d %H:%M:%S") %>
                          </div>
                        </td>
                        <td>
                          <span class="ms-4 text-nowrap d-inline-block">State：<%= order.status.capitalize %></span>
                        </td>
                        <td>
                          <span class="ms-3 text-nowrap d-inline-block">Amount：$<%= order.total_price %></span>
                        </td>
                        <td>
                          <%= link_to "Check Details", order_path(order), data: { turbo: false }, class: "btn btn-outline-secondary text-nowrap btn-sm" %>
                        </td>
                      </tr>
                    <% end %>
                  <% else %>
                    <tr>
                      <td colspan="5" class="text-center text-muted py-4">No orders found.</td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
